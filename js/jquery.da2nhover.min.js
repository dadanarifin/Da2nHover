/*
 * da2nhover jQuery Image Hover Plugin
 * http://dadanarifin.com
 *
 * Copyright 2013, Dadan Arifin
 * Free to use under the MIT license.
 * http://www.opensource.org/licenses/mit-license.php
 * 
 */
(function(e){e.fn.da2nhover=function(t){function r(t,n){for(var r=0;r<n.slices;r++){var i=Math.round(t.width()/n.slices);if(r==n.slices-1){t.children(".da2nhover-after").append(e('<div class="da2nhover-slice"></div>').css({left:i*r+"px",width:t.width()-i*r+"px",height:"0px",opacity:"0",background:'url("'+t.children("img").attr("src")+'") no-repeat -'+(i+r*i-i)+"px 0%"}))}else{t.children(".da2nhover-after").append(e('<div class="da2nhover-slice"></div>').css({left:i*r+"px",width:i+"px",height:"0px",opacity:"0",background:'url("'+t.children("img").attr("src")+'") no-repeat -'+(i+r*i-i)+"px 0%"}))}}}function i(t,n){var r=Math.round(t.width()/n.boxCols);var i=Math.round(t.height()/n.boxRows);for(var s=0;s<n.boxRows;s++){for(var o=0;o<n.boxCols;o++){if(o==n.boxCols-1){t.children(".da2nhover-after").append(e('<div class="da2nhover-box"></div>').css({opacity:0,left:r*o+"px",top:i*s+"px",width:t.width()-r*o+"px",height:i+"px",background:'url("'+t.children("img").attr("src")+'") no-repeat -'+(r+o*r-r)+"px -"+(i+s*i-i)+"px"}))}else{t.children(".da2nhover-after").append(e('<div class="da2nhover-box"></div>').css({opacity:0,left:r*o+"px",top:i*s+"px",width:r+"px",height:i+"px",background:'url("'+t.children("img").attr("src")+'") no-repeat -'+(r+o*r-r)+"px -"+(i+s*i-i)+"px"}))}}}}function s(e){for(var t,n,r=e.length;r;t=parseInt(Math.random()*r),n=e[--r],e[r]=e[t],e[t]=n);return e}function o(e){var t=document.createElement("canvas");var n=t.getContext("2d");var r=new Image;r.src=e;t.width=r.width;t.height=r.height;n.drawImage(r,0,0);var i=n.getImageData(0,0,t.width,t.height);for(var s=0;s<i.height;s++){for(var o=0;o<i.width;o++){var u=s*4*i.width+o*4;var a=(i.data[u]+i.data[u+1]+i.data[u+2])/3;i.data[u]=a;i.data[u+1]=a;i.data[u+2]=a}}n.putImageData(i,0,0,0,0,i.width,i.height);return t.toDataURL()}var n=e.extend({startEffect:"transparent",hoverEffect:"normal",imageOpacity:.5,animSpeed:300,fillColor:"#000",textColor:"#fff",overlayText:"",slices:10,boxCols:5,boxRows:3,MarginOut:10,ShadowOut:10},t);e(this).one("load",function(){e(this).wrap(function(){return'<div class="da2nhover-wrapper '+e(this).attr("class")+'" style="width:'+e(this).width()+"px; height:"+e(this).height()+'px;"/>'});e(this).parent().append('<div class="da2nhover-before '+e(this).attr("class")+'" style="display:none;width:'+e(this).width()+"px; height:"+e(this).height()+'px;"><img src="'+e(this).attr("src")+'"/></div>');e(this).parent().append('<div class="da2nhover-after '+e(this).attr("class")+'" style="display:none;width:'+e(this).width()+"px; height:"+e(this).height()+'px;"></div>');if(n.startEffect=="transparent"){e(this).hide();e(this).siblings(".da2nhover-before").css({"-ms-filter":'"progid:DXImageTransform.Microsoft.Alpha(Opacity='+n.imageOpacity*100+')"',filter:"alpha(opacity="+n.imageOpacity*100+")","-moz-opacity":n.imageOpacity,"-khtml-opacity":n.imageOpacity,opacity:n.imageOpacity}).show()}else if(n.startEffect=="grayscale"){var t=e(this);t.hide();t.siblings(".da2nhover-before").show();t.siblings(".da2nhover-before").children("img").each(function(){this.src=o(this.src)})}else if(n.startEffect=="normal"){e(this).hide();e(this).siblings(".da2nhover-before").show()}else if(n.startEffect=="overlay"){t=e(this);t.hide();e(this).siblings(".da2nhover-before").html(n.overlayText).css({"-ms-filter":'"progid:DXImageTransform.Microsoft.Alpha(Opacity='+n.imageOpacity*100+')"',filter:"alpha(opacity="+n.imageOpacity*100+")","-moz-opacity":n.imageOpacity,"-khtml-opacity":n.imageOpacity,opacity:n.imageOpacity,background:n.fillColor,color:n.textColor}).fadeIn();t.show()}e(this).parent().bind("mouseenter",function(){if(n.hoverEffect=="normal"){var t=e(this);t.children(".da2nhover-after").html('<img src="'+t.children("img").attr("src")+'"/>').fadeIn(n.animSpeed)}else if(n.hoverEffect=="popout"){t=e(this);var o=t.children("img").width();var u=t.children("img").height();t.children(".da2nhover-after").html('<img src="'+t.children("img").attr("src")+'"/>');var a=t.children(".da2nhover-after").children("img");a.width(o+2*n.MarginOut);a.height(u+2*n.MarginOut);t.children(".da2nhover-after").width(o+2*n.MarginOut);t.children(".da2nhover-after").height(u+2*n.MarginOut);t.children(".da2nhover-after").css({left:"-"+n.MarginOut+"px",top:"-"+n.MarginOut+"px","box-shadow":"0px 0px "+n.ShadowOut+"px #000"}).show()}else if(n.hoverEffect=="sliceDown"||n.hoverEffect=="sliceDownLeft"||n.hoverEffect=="sliceUp"||n.hoverEffect=="sliceUpLeft"||n.hoverEffect=="sliceUpRandom"||n.hoverEffect=="sliceDownRandom"){e(this).children(".da2nhover-after").show();r(e(this),n);var f=0;var l=0;var c=e(".da2nhover-slice",e(this));if(n.hoverEffect=="sliceDownLeft"||n.hoverEffect=="sliceUpLeft")c=e(".da2nhover-slice",e(this))._reverse();if(n.hoverEffect=="sliceUpRandom"||n.hoverEffect=="sliceDownRandom")c=s(e(".da2nhover-slice",e(this)));c.each(function(){var t=e(this);if(n.hoverEffect=="sliceDown"||n.hoverEffect=="sliceDownLeft"){t.css({top:"0px"})}else if(n.hoverEffect=="sliceUp"||n.hoverEffect=="sliceUpLeft"){t.css({bottom:"0px"})}if(l==n.slices-1){setTimeout(function(){t.animate({height:"100%",opacity:"1.0"},n.animSpeed,"",function(){})},100+f)}else{setTimeout(function(){t.animate({height:"100%",opacity:"1.0"},n.animSpeed)},100+f)}f+=50;l++})}else if(n.hoverEffect=="sliceUpDown"||n.hoverEffect=="sliceUpDownLeft"){e(this).children(".da2nhover-after").show();r(e(this),n);f=0;l=0;var h=0;c=e(".da2nhover-slice",e(this));if(n.hoverEffect=="sliceUpDownLeft")c=e(".da2nhover-slice",e(this))._reverse();c.each(function(){var t=e(this);if(l==0){t.css("top","0px");l++}else{t.css("bottom","0px");l=0}if(h==n.slices-1){setTimeout(function(){t.animate({height:"100%",opacity:"1.0"},n.animSpeed,"",function(){})},100+f)}else{setTimeout(function(){t.animate({height:"100%",opacity:"1.0"},n.animSpeed)},100+f)}f+=50;h++})}else if(n.hoverEffect=="fold"||n.hoverEffect=="foldLeft"){e(this).children(".da2nhover-after").show();t=e(this);r(t,n);f=0;l=0;c=e(".da2nhover-slice",t);if(n.hoverEffect=="foldLeft")c=e(".da2nhover-slice",e(this))._reverse();c.each(function(){var t=e(this);var r=t.width();t.css({top:"0px",height:"100%",width:"0px"});if(l==n.slices-1){setTimeout(function(){t.animate({width:r,opacity:"1.0"},n.animSpeed,"",function(){})},100+f)}else{setTimeout(function(){t.animate({width:r,opacity:"1.0"},n.animSpeed)},100+f)}f+=50;l++})}else if(n.hoverEffect=="boxRandom"){e(this).children(".da2nhover-after").show();t=e(this);i(t,n);var p=n.boxCols*n.boxRows;l=0;f=0;var d=s(e(".da2nhover-box",t));d.each(function(){var t=e(this);if(l==p-1){setTimeout(function(){t.animate({opacity:"1"},n.animSpeed,"",function(){})},100+f)}else{setTimeout(function(){t.animate({opacity:"1"},n.animSpeed)},100+f)}f+=20;l++})}else if(n.hoverEffect=="boxRain"||n.hoverEffect=="boxRainReverse"||n.hoverEffect=="boxRainGrow"||n.hoverEffect=="boxRainGrowReverse"){e(this).children(".da2nhover-after").show();t=e(this);i(t,n);p=n.boxCols*n.boxRows;l=0;f=0;var v=0;var m=0;var g=new Array;g[v]=new Array;d=e(".da2nhover-box",t);if(n.hoverEffect=="boxRainReverse"||n.hoverEffect=="boxRainGrowReverse"){d=e(".da2nhover-box",t)._reverse()}d.each(function(){g[v][m]=e(this);m++;if(m==n.boxCols){v++;m=0;g[v]=new Array}});for(var y=0;y<n.boxCols*2;y++){var b=y;for(var w=0;w<n.boxRows;w++){if(b>=0&&b<n.boxCols){(function(t,r,i,s,o){var u=e(g[t][r]);var a=u.width();var f=u.height();if(n.hoverEffect=="boxRainGrow"||n.hoverEffect=="boxRainGrowReverse"){u.width(0).height(0)}if(s==o-1){setTimeout(function(){u.animate({opacity:"1",width:a,height:f},n.animSpeed/1.3,"",function(){})},100+i)}else{setTimeout(function(){u.animate({opacity:"1",width:a,height:f},n.animSpeed/1.3)},100+i)}})(w,b,f,l,p);l++}b--}f+=100}}});e(this).parent().bind("mouseleave",function(){e(this).children(".da2nhover-after").html("").hide()})}).each(function(){if(this.complete)e(this).load()});return e(this)};e.fn._reverse=[].reverse})(jQuery)